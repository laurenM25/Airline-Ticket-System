<!DOCTYPE html>
<html>

<head>
    <title>Modify flight status</title>
    <link rel="stylesheet" href="static/general.css">
</head>

<body>
    <div class="topBar">
        <div class="left-top"></div>
        <div class="center-top">
            <span class="webpage-title">Air Ticket Reservation </span>
        </div>
        <div class="right-top">
            <span class="username">Welcome {{username}}</span>
            <a class='logout-link' href="/logout">log out</a>
        </div>
    </div>
    <div class="sideNav">
        <h3>Tools</h3>
        {% if usertype %}
        {% if usertype == "customer" %}
        <a class='page-link' href="/browseFlights">Browse Flights</a>
        <a class='page-link' href="/purchasedFlights">View purchased flights</a>
        <a class='page-link' href="/spendingStats">View spending stats</a>
        {% endif %}

        {% if usertype == "agent" %}
        <a class='page-link' href="/purchasedFlightsA">View flights purchased for clients</a>
        <a class='page-link' href="/browseFlightsA">Browse flights</a>
        <a class='page-link' href="/analyticsA">Analytics</a>
        {% endif %}

        {% if usertype == "airline_staff" %}
        <a class='page-link' href="/upcomingFlightsStaff">View upcoming flights for your airline</a>
        <a class='page-link' href="/passengerList">Check passenger list by flight number</a>
        <a class='page-link' href="/customersFlights">Look up flights taken by a customer</a>
        <a class='page-link' href="/analyticsStaff">Analytics</a>
        {% endif %}

        {% endif %}

        {% if specialperm %}
        {% if "admin" in specialperm %}
        <h3>Admin Tools</h3>
        <a class='page-link' href="/addAirport">Add new airport</a>
        <a class='page-link' href="/addAirplane">Add new airplane</a>
        <a class='page-link' href="/createFlight">Create flight</a>
        <a class='page-link' href="/assignAgent">Assign agent to airline</a>
        {% endif %}

        {% if "operator" in specialperm %}
        <h3>Operator Tools</h3>
        <a class='page-link' href="/updateStatus">Update flight status</a>
        {% endif %}
        {% endif %}
    </div>

    <div class="main-content">
        <h2>Modify Flight Status ({{ airline }})</h2>

        {% if success %}
        <p style="color: green; font-weight: 600;">{{ success }}</p>
        {% endif %}
        {% if error %}
        <p style="color: red; font-weight: 600;">{{ error }}</p>
        {% endif %}

        <form action="/confirmStatusUpdate" method="POST">
            <label for="flight-num">Select flight:</label>
            <select name="flight-num" id="flight-num" required>
                {% for f in flights %}
                <!-- f = (flight_num, dep_time, arr_time, dep_airport, arr_airport, status) -->
                <option value="{{ f[0] }}">{{ f[0] }} — {{ f[3] }}→{{ f[4] }} — current: {{ f[5] }}</option>
                {% endfor %}
            </select>

            <label for="new-status">New status:</label>
            <select name="new-status" id="new-status" required>
                <option value="upcoming">upcoming</option>
                <option value="in-progress">in-progress</option>
                <option value="delayed">delayed</option>
            </select>

            <input type="submit" value="Update Status">
        </form>

        <hr>

        <h3>Your flights</h3>
        <table border="1" cellpadding="6">
            <tr>
                <th>Flight #</th>
                <th>Departure</th>
                <th>Arrival</th>
                <th>From</th>
                <th>To</th>
                <th>Status</th>
            </tr>
            {% for f in flights %}
            <tr>
                <td>{{ f[0] }}</td>
                <td>{{ f[1] }}</td>
                <td>{{ f[2] }}</td>
                <td>{{ f[3] }}</td>
                <td>{{ f[4] }}</td>
                <td>{{ f[5] }}</td>
            </tr>
            {% endfor %}
        </table>
    </div>
</body>

</html>